postgres:
  image: 'postgres:9.6-alpine'
  restart: always
  environment:
    POSTGRES_USER: 'postgres'
    POSTGRES_PASSWORD: 'supersecret'

redis:
  image: 'redis:3.2-alpine'
  restart: always

api:
  image: 'tmartin8080/twapp-api:latest'
  autoredeploy: true
  restart: always
  environment:
    - RAILS_ENV=production
    - RAILS_MAX_THREADS=5
    - 'REDIS_URL=redis://redis:6379/0'
    - SECRET_KEY_BASE=b4f498b1c9f77a0644ae955e8e301c046eccbc5df7fd807c816aba1922db9c35c02a7a0b9efa72c07284a19807614f82c99c44bdd7cf1aea688b410df6911418
    - DB_HOST=postgres
    - DB_USER=postgres
    - DB_PASSWORD=supersecret
    - TWITTER_CONSUMER_KEY=1LBw3xBlANZS6mmDDaEEVJNuN
    - TWITTER_CONSUMER_SECRET=lSFCKMz2zZMihS9yK3uxWw4V7Q94ZpYfXy8jnAtmNzWGBj0Xf8
    - TWITTER_ACCESS_TOKEN=965049316606926848-VlJYOUHONrwna7lZFopHWX6hMeW0EuX
    - TWITTER_SECRET_TOKEN=XYtC7vBWeuDsgrtCGPaj9fdPdanYqUcA5fr9f1GYcqfvs

  links:
    - postgres
    - redis
  ports:
    - '80'

